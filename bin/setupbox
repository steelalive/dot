
# vi: set ft=sh:
setupbox() {
toylist='acpi 
arp 
base64 
basename 
blkid 
blockdev 
bzcat 
cal 
cat 
chattr 
chcon 
chgrp 
chmod 
chown 
chroot 
chrt 
cksum 
clear 
cmp 
comm 
cp 
cpio 
cut 
date 
dd 
df 
diff 
dirname 
dmesg 
dos2unix 
du 
echo 
egrep 
env 
expand 
expr 
fallocate 
false 
fdisk 
fgrep 
file 
find 
flock 
free 
freeramdisk 
fsfreeze 
fstype 
ftpget 
ftpput 
getenforce 
getfattr 
getprop 
grep 
groups 
head 
help 
host 
hostname 
hwclock 
id 
ifconfig 
inotifyd 
insmod 
install 
ionice 
iorenice 
iotop 
kill 
killall 
ln 
load_policy 
log 
logname 
losetup 
ls 
lsattr 
lsmod 
lsof 
lspci 
lsusb 
makedevs 
md5sum 
mkdir 
mkfifo 
mknod 
mkswap 
mktemp 
modinfo 
more 
mount 
mountpoint 
mv 
nbd-client 
nc 
netcat 
netstat 
nice 
nl 
nohup 
nproc 
od 
partprobe 
paste 
patch 
pgrep 
pidof 
pivot_root 
pkill 
pmap 
printenv 
printf 
ps 
pwd 
pwdx 
readahead 
readlink 
realpath 
renice 
reset 
resize 
restorecon 
rev 
rfkill 
rm 
rmdir 
rmmod 
route 
runcon 
sed 
sendevent 
seq 
setenforce 
setfattr 
setprop 
setsid 
sha1sum 
sha224sum 
sha256sum 
sha384sum 
sha512sum 
sleep 
sort 
split 
start 
stat 
stop 
strings 
swapoff 
swapon 
sync 
sysctl 
tac 
tail 
tar 
taskset 
tee 
telnet 
test 
time 
timeout 
top 
touch 
tr 
traceroute 
traceroute6 
true 
truncate 
tty 
tunctl 
ulimit 
umount 
uname 
uniq 
unix2dos 
uptime 
usleep 
vconfig 
vmstat 
watch 
wc 
which 
whoami 
xargs 
xxd 
xzcat
yes'

busylist='[
[[
acpid
add-shell
addgroup
adduser
adjtimex
ar
arch
arp
arping
ash
awk
base64
basename
bash
bbconfig
beep
blkdiscard
blkid
blockdev
bootchartd
brctl
bunzip2
bzcat
bzip2
cal
cat
chat
chattr
chcon
chgrp
chmod
chown
chpasswd
chpst
chroot
chrt
chvt
cksum
clear
cmp
comm
conspy
cp
cpio
crond
crontab
cryptpw
cttyhack
cut
date
dc
dd
deallocvt
delgroup
deluser
depmod
devmem
df
dhcprelay
diff
dirname
dmesg
dnsd
dnsdomainname
dos2unix
dpkg
dpkg-deb
du
dumpkmap
dumpleases
echo
ed
egrep
eject
env
envdir
envuidgid
ether-wake
expand
expr
factor
fakeidentd
fallocate
false
fatattr
fbset
fbsplash
fdflush
fdformat
fdisk
fgconsole
fgrep
find
findfs
flash_eraseall
flash_lock
flash_unlock
flashcp
flock
fold
free
freeramdisk
fsck
fsck.minix
fsfreeze
fstrim
fsync
ftpd
ftpget
ftpput
fuser
getenforce
getopt
getsebool
getty
grep
groups
gunzip
gzip
halt
hd
hdparm
head
hexdump
hexedit
hostid
hostname
httpd
hush
hwclock
i2cdetect
i2cdump
i2cget
i2cset
id
ifconfig
ifdown
ifenslave
ifplugd
ifup
inetd
init
inotifyd
insmod
install
ionice
iostat
ip
ipaddr
ipcalc
ipcrm
ipcs
iplink
ipneigh
iproute
iprule
iptunnel
kbd_mode
kill
killall
killall5
klogd
last
less
link
linux32
linux64
linuxrc
ln
load_policy
loadfont
loadkmap
logger
login
logname
logread
losetup
lpd
lpq
lpr
ls
lsattr
lsmod
lsof
lspci
lsscsi
lsusb
lunzip
lzcat
lzip
lzma
lzop
lzopcat
makedevs
makemime
man
matchpathcon
md5sum
mdev
mesg
microcom
mkdir
mkdosfs
mke2fs
mkfifo
mkfs.ext2
mkfs.minix
mkfs.reiser
mkfs.vfat
mknod
mkpasswd
mkswap
mktemp
modinfo
modprobe
more
mount
mountpoint
mpstat
mt
mv
nameif
nanddump
nandwrite
nbd-client
nc
netstat
nice
nl
nmeter
nohup
nproc
nsenter
nslookup
ntpd
nuke
od
openvt
partprobe
passwd
paste
patch
pgrep
pidof
ping
ping6
pipe_progress
pivot_root
pkill
pmap
popmaildir
poweroff
powertop
printenv
printf
ps
pscan
pstree
pwd
pwdx
raidautorun
rdate
rdev
readahead
readlink
readprofile
realpath
reboot
reformime
remove-shell
renice
reset
resize
restorecon
resume
rev
rfkill
rm
rmdir
rmmod
route
rpm
rpm2cpio
rtcwake
run-init
run-parts
runcon
runlevel
runsv
runsvdir
rx
script
scriptreplay
sed
selinuxenabled
sendmail
seq
sestatus
setarch
setconsole
setenforce
setfattr
setfiles
setfont
setkeycodes
setlogcons
setpriv
setsebool
setserial
setsid
setuidgid
sh
sha1sum
sha256sum
sha3sum
sha512sum
showkey
shred
shuf
slattach
sleep
smemcap
softlimit
sort
split
ssl_client
start-stop-daemon
stat
strings
stty
sum
sv
svc
svlogd
svok
swapoff
swapon
switch_root
sync
sysctl
syslogd
tac
tail
tar
taskset
tc
tcpsvd
tee
telnet
telnetd
test
tftp
tftpd
time
timeout
top
touch
tr
traceroute
traceroute6
true
truncate
tty
ttysize
tunctl
tune2fs
ubiattach
ubidetach
ubimkvol
ubirename
ubirmvol
ubirsvol
ubiupdatevol
udhcpc
udhcpc6
udhcpd
udpsvd
uevent
umount
uname
uncompress
unexpand
uniq
unix2dos
unlink
unlzma
unlzop
unshare
unxz
unzip
uptime
users
usleep
uudecode
uuencode
vconfig
vi
vlock
volname
w
wall
watch
watchdog
wc
wget
which
who
whoami
whois
xargs
xxd
xz
xzcat
yes
zcat
zcip'

corelist='b2sum 
base32 
base64 
basename 
basenc 
cat 
chcon 
chgrp 
chmod 
chown 
chroot 
cksum 
comm 
cp 
csplit 
cut 
date 
dd 
df 
dir 
dircolors 
dirname 
du 
echo 
env 
expand 
expr 
factor 
false 
fmt 
fold 
ginstall 
groups 
head 
hostid 
id 
join 
kill 
link 
ln 
logname 
ls 
md5sum 
mkdir 
mkfifo 
mknod 
mktemp 
mv 
nice 
nl 
nohup 
nproc 
numfmt 
od 
paste 
pathchk 
pinky 
pr 
printenv 
printf 
ptx 
pwd 
readlink 
realpath 
rm 
rmdir 
runcon 
seq 
sha1sum 
sha224sum 
sha256sum 
sha384sum 
sha512sum 
shred 
shuf 
sleep 
split 
stat 
stty 
sum 
sync 
tac 
tail 
tee 
test 
touch 
tr 
true 
truncate 
tsort 
tty 
uname 
unexpand 
uniq 
unlink 
uptime 
users 
vdir 
wc 
who 
whoami 
yes'



	[[ $1 ]] || return
	mkdir -pv "$1"
	cp -av "$slash/sbin/coreutils" "$1"
	cp -av "$slash/sbin/busybox" "$1"
	cp -av "$ex/misc-android/toybox-aarch64" "$1/toybox"
	(
		cd "$1" || echo "error $LINE_NO"
        ANY "Setup Busybox in $1...${R}\n"
		for exe in $busylist; do 
            ln -sv ./busybox "$exe" && ANORANGE "busybox linked with ${W}$exe $R\n"
        done
        ANY "Setup coreutils in $1...${R}\n"
		for exe in $corelist; do 
            ln -sv ./coreutils "$exe" && ANORANGE "coreutils linked with ${W}$exe $R\n"
        done
        ANY "Setup toybox in $1...${R}\n"
		for exe in $toylist; do 
            ln -sv ./toybox "$exe" && ANORANGE "Toybox linked with ${W}$exe $R\n"
        done
		[[ -L su ]] && rm su sulogin
		[[ -L bash ]] && rm bash
		cp -av $slash/sbin/bash ./bash
		cp -av $slash/sbin/nano* ./
		cp -av $slash/etc/mk ./
		cp -av $slash/etc/rc ./
        chmod 4755 ./bash busybox toybox coreutils nano*
	)
}

setupbox "$@"
