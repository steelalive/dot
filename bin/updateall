#!/bin/bash
#-*- coding: utf-8 -*-
#2#::.. Last edit: - Wed May 30 08:24:14 EDT 2018 - by: - steelalive - ..::## #_# - VERSION=0.0.5.8 - #_# #@#300518#@# #2#
#3#::..#####################_MAIN_#######################..::#3#
# Author: #noharden

#wp check for wirelless porn. If there is porn still on the internet, we may continue.
wp || exit

#I like the ccache to proudly display my name.
[[ -d $CCACHE_DIR ]] && +user -R $CCACHE_DIR $CCACHE_TEMPDIR 2>/dev/null

#Here, I update things.
suuser "yay -Syu --devel --needed --noconfirm" || {
	ANBRED "Error pamcan -Syu!$R\n"
	exit
}
suuser "yay -S --needed --noconfirm -ua"
paccache --keep 1 --verbose --remove
#That's it! We are done!

#Never EVER! execute updateall something.
[[ $1 ]] && {
	is_in_path go && go get -u all

	for i in /root/.gem/ruby/*/bin /root/.gem/ruby/*/ /root/.gem/ruby /root/.gem /root /root/.vim_runtime /ext/opt/diet/bin /ext/opt/diet /ext/opt /ext /ext/opt/gcc-UBERTC/bin; do
		[[ -e $i ]] && chmod go-w "$i"
	done

	for i in updateRuby update_rubygems update-pciids update-ca-trust update-desktop-database; do
		is_in_path "$i" && ANORANGE "Executing ${i}...\\n" && "$i"
	done
	### Back to relative sanity.

	#This take care of android-studio. I now have duplicated mountain of executables a little more ordered than android source.
	#[[ $1 ]] && sdkmanager --update

	#When pacman is away, mice dances and maintain the latest of the late ruby code
	is_in_path bundle && bundle update

	### this line may not fit your config. All the previous lines as well.:
	[[ -d "$HOME"/.cache/pip ]] && chown root:root "$HOME"/.cache/pip "$HOME"/.cache/pip/http

	###This is supposed to save me HOURS if I chmod 777 /usr...
	pacman -Q | awk '{print $1}' >/packages.list

	#Permissions are taken care of
	rm -rf /tmp/makepkg

	###I don't know what the following one liners i grabbed on warez do...###

	#Not recommended pip maintenance, alwyas use the package manager...
	$(ncu -g | grep 'npm -g install ')
	$(pip-check -c pip2 -rfHu 2>/dev/null | grep -o "pip.* install -U .*")
	$(pip-check -c pip3 -rfHu 2>/dev/null | grep -o "pip.* install -U .*")

	#Same warning for npm
	npm install --global --upgrade npm@latest
	npm-check -g -y
	npm update -g
	npm doctor

	#Let's do the same mystake with perl scripts. Just use the damned package manager. pacman -Syu and have a baby or make passionate love to a man.
	if is_in_path cpanm && is_in_path cpanm-outdated; then
		cpanm --self-upgrade
		cpan-outdated -p | cpanm
	fi
	cpan -u

	### Neovim setup ###
	cd /root/.config/nvim || echo no && {
		gitreset
		local="$dot/root/folders/.config/nvim/local.vim"
		init="$HOME/.config/nvim/init.vim"
		if ! grep -q "$local" $init; then
			echo "source $local" >>"$init"
		fi
		unset local init
		nvim -N -u /root/.config/nvim/init.vim -c "try | call dein#update() | UpdateRemotePlugins | finally | qall! | qall! | endtry" -V1 -es
		if cd $dot/root/.dotfiles2; then
			make update
		fi
	}
	###CHeck for mising files or disparities with pacman database
	paccheck | grep -v -e 'all dependencies satisfied' -e 'all files match database' -e "cw:" -e "memtest86+" -e "linux:" -e "system-config-printer"
}
### END Neovim setup ###
